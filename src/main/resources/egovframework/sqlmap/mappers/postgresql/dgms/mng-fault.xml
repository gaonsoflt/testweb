<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="egovframework.dgms.service.impl.MngFaultMapper">


	
    
    <select id="selectMngFaultInfo" parameterType="hashMap" resultType="hashMap">

	    SELECT *
	      FROM (SELECT ROWNUM RNUM, A.*
	              FROM (SELECT A.RENT_FAULT_SEQ
						      ,EQUIP_TYPE
						      ,MODEL_NM
						      ,SERIAL_NO
						      ,A.SUBJECT
						      ,A.CONTENTS
						      ,A.WRITER_ID
						      ,A.WRITE_DT
						      ,A.WORKER_ID
						      ,A.WORK_DT
						      ,A.RESULT
						      ,A.RESULT_STATE
						      ,A.ACCEPTER_ID
						      ,A.ACCEPT_DT
						      ,A.CRE_USR
						      ,A.CRE_DT
						      ,A.MOD_USR
						      ,A.MOD_DT
						  FROM TB_RENT_FAULT A
	                     WHERE 1=1
				         <if test='RENT_FAULT_SEQ != null and RENT_FAULT_SEQ != "" '>
				           AND A.RENT_FAULT_SEQ = #{RENT_FAULT_SEQ}
				         </if>
				         <if test='SUBJECT != null and SUBJECT != "" '>
				           AND A.SUBJECT LIKE '%' || #{SUBJECT} || '%'
				         </if>
				         <if test='CONTENTS != null and CONTENTS != "" '>
				           AND A.CONTENTS LIKE '%' || #{CONTENTS} || '%'
				         </if>
				         <if test='FROM_DATE != null and FROM_DATE != "" '>
				           AND A.WRITE_DT &gt;= #{FROM_DATE}
				         </if>
				         <if test='TO_DATE != null and TO_DATE != "" '>
				           AND A.WRITE_DT &lt;= #{TO_DATE}
	                     </if>
	                     <if test='ACCEPTER_ID != null and ACCEPTER_ID != "" '>
				           AND A.ACCEPTER_ID = #{ACCEPTER_ID}
	                     </if>
	                     
	                     
	                     ORDER BY A.WRITE_DT desc
	                     ) A
	           ) A
	     WHERE 1 = 1
		<if test='PAGE != null'>
		<![CDATA[
	       AND A.RNUM > (#{PAGE} - 1) * #{PAGESIZE}
	       AND A.RNUM <= #{PAGE} * #{PAGESIZE}
    	]]>
		</if>

    </select>
    
    
    <select id="selectMngFaultInfoTot" parameterType="hashMap" resultType="int">

	    SELECT COUNT(*)
	      FROM TB_RENT_FAULT A
	     WHERE 1 = 1
         <if test='RENT_FAULT_SEQ != null and RENT_FAULT_SEQ != "" '>
           AND A.RENT_FAULT_SEQ = #{RENT_FAULT_SEQ}
         </if>
         <if test='SUBJECT != null and SUBJECT != "" '>
           AND A.SUBJECT LIKE '%' || #{SUBJECT} || '%'
         </if>
         <if test='CONTENTS != null and CONTENTS != "" '>
           AND A.CONTENTS LIKE '%' || #{CONTENTS} || '%'
         </if>
         <if test='FROM_DATE != null and FROM_DATE != "" '>
           AND A.WRITE_DT &gt;= #{FROM_DATE}
         </if>
         <if test='TO_DATE != null and TO_DATE != "" '>
           AND A.WRITE_DT &lt;= #{TO_DATE}
         </if>
    </select>
    
    
    
    <insert id="insertMngFaultInfo" >
	    INSERT INTO TB_RENT_FAULT
	      (
	      	   RENT_FAULT_SEQ
		      ,EQUIP_TYPE
		      ,MODEL_NM
		      ,SERIAL_NO
		      ,SUBJECT
		      ,CONTENTS
		      ,WRITER_ID
		      ,WRITE_DT
		      ,WORKER_ID
		      ,WORK_DT
		      ,RESULT
		      ,RESULT_STATE
		      ,ACCEPTER_ID
		      ,ACCEPT_DT
		      ,CRE_USR
		      ,CRE_DT
		      ,MOD_USR
		      ,MOD_DT
	      )
	    VALUES
	      (
			#{RENT_FAULT_SEQ,  jdbcType=VARCHAR},
			#{EQUIP_TYPE    ,  jdbcType=VARCHAR},
			#{MODEL_NM     	,  jdbcType=VARCHAR},
			#{SERIAL_NO     ,  jdbcType=VARCHAR},
			#{SUBJECT     	,  jdbcType=VARCHAR},
			#{CONTENTS		,  jdbcType=VARCHAR},
			#{WRITER_ID		,  jdbcType=VARCHAR},
			#{WRITE_DT		,  jdbcType=VARCHAR},
			#{WORKER_ID     ,  jdbcType=VARCHAR},
			#{WORK_DT     	,  jdbcType=VARCHAR},
			#{RESULT 		,  jdbcType=VARCHAR},
			#{RESULT_STATE	,  jdbcType=VARCHAR},
			#{ACCEPTER_ID  	,  jdbcType=VARCHAR},
			#{ACCEPT_DT 	,  jdbcType=VARCHAR},
			#{CRE_USR       ,  jdbcType=VARCHAR},
			SYSDATE                             ,
			#{MOD_USR       ,  jdbcType=VARCHAR},
			SYSDATE
	       ) 
		
	</insert>

	<update id="updateMngFaultInfo" >
	
    UPDATE TB_RENT_FAULT
       SET 
       		EQUIP_TYPE =
			#{EQUIP_TYPE    ,  jdbcType=VARCHAR},
			MODEL_NM =
			#{MODEL_NM     	,  jdbcType=VARCHAR},
			SERIAL_NO =
			#{SERIAL_NO     ,  jdbcType=VARCHAR},
			SUBJECT =
			#{SUBJECT     	,  jdbcType=VARCHAR},
			CONTENTS =
			#{CONTENTS		,  jdbcType=VARCHAR},
			WRITER_ID =
			#{WRITER_ID		,  jdbcType=VARCHAR},
			WRITE_DT =
			#{WRITE_DT		,  jdbcType=VARCHAR},
			WORKER_ID =
			#{WORKER_ID     ,  jdbcType=VARCHAR},
			WORK_DT =
			#{WORK_DT     	,  jdbcType=VARCHAR},
			RESULT =
			#{RESULT 		,  jdbcType=VARCHAR},
			RESULT_STATE =
			#{RESULT_STATE	,  jdbcType=VARCHAR},
			ACCEPTER_ID =
			#{ACCEPTER_ID  	,  jdbcType=VARCHAR},
			ACCEPT_DT =
			#{ACCEPT_DT 	,  jdbcType=VARCHAR},
			MOD_USR =
			#{MOD_USR       ,  jdbcType=VARCHAR},
			MOD_DT      = SYSDATE
     WHERE RENT_FAULT_SEQ = #{RENT_FAULT_SEQ}
     
	</update>
	
	
    <update id="deleteMngFaultInfo" >
	    DELETE FROM TB_RENT_FAULT
		 WHERE RENT_FAULT_SEQ = #{RENT_FAULT_SEQ}
    </update>
	    

    
<!--     <select id="selectCdNmCombo" parameterType="hashMap" resultType="hashMap">
	<![CDATA[
		SELECT CATGR,
		       CD,
		       LPAD(' ', 2 * (LEVEL - 1), '>') || CD_NM  AS CD_NM_PATH,
		       CD_NM,
		       SORT_NO,
		       DEUser(USE_YN,'0','false','true')  USE_YN  , 
		       LEVEL
		  FROM TB_User_MASTER
		 WHERE LEVEL <= 2
		 START WITH CATGR = 0
		CONNECT BY CATGR = PRIOR CD
	]]>
    </select>
    
    <select id="selectMngFaultInfoCombo" parameterType="hashMap" resultType="hashMap">
    	<![CDATA[
	    SELECT * 
        FROM TB_User_MASTER 
       ORDER BY SORT_NO
    	]]>
    </select> -->
    
    
    
</mapper>
